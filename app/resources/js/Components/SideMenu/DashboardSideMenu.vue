<script setup>
import { ref, watch } from "vue";
import { Link } from "@inertiajs/vue3";

const selectedMenuItem = ref(
    parseInt(localStorage.getItem("selectedMenuItem"))
);

const selectMenuItem = (id) => {
    selectedMenuItem.value = id;
    localStorage.setItem("selectedMenuItem", id);
};

const menuItems = [
    {
        id: 0,
        route: "top",
        label: "ダッシュボード",
        path: "M21.3113 6.87821L17.1216 2.68946C16.9823 2.55014 16.8169 2.43962 16.6349 2.36421C16.4529 2.28881 16.2578 2.25 16.0608 2.25C15.8638 2.25 15.6687 2.28881 15.4867 2.36421C15.3047 2.43962 15.1393 2.55014 15 2.68946L3.4397 14.2498C3.2998 14.3886 3.18889 14.5538 3.11341 14.7358C3.03792 14.9178 2.99938 15.113 3.00001 15.3101V19.4998C3.00001 19.8976 3.15804 20.2791 3.43935 20.5604C3.72065 20.8417 4.10218 20.9998 4.50001 20.9998H20.25C20.4489 20.9998 20.6397 20.9208 20.7803 20.7801C20.921 20.6395 21 20.4487 21 20.2498C21 20.0509 20.921 19.8601 20.7803 19.7194C20.6397 19.5788 20.4489 19.4998 20.25 19.4998H10.8113L21.3113 8.99977C21.4506 8.86048 21.5611 8.69511 21.6365 8.5131C21.7119 8.33108 21.7507 8.136 21.7507 7.93899C21.7507 7.74198 21.7119 7.5469 21.6365 7.36489C21.5611 7.18288 21.4506 7.0175 21.3113 6.87821ZM12.75 7.06009L14.3147 8.62477L6.37501 16.5645L4.81032 14.9998L12.75 7.06009ZM4.50001 19.4998V16.8101L7.1897 19.4998H4.50001ZM9.00001 19.1895L7.43626 17.6248L15.375 9.68508L16.9397 11.2498L9.00001 19.1895ZM18 10.1895L13.8113 5.99977L16.0613 3.74977L20.25 7.93946L18 10.1895Z",
        fill: "#4D4D4D",
        viewBox: "0 0 24 24",
        routerActive: ["/top"],
        regexRouterActive: [],
    },
    {
        id: 1,
        route: "top",
        label: "レッスン管理",
        path: "M23.2155 0.739989C23.2048 0.556506 23.127 0.383346 22.9971 0.253383C22.8671 0.123421 22.6939 0.045704 22.5105 0.0349889C17.658 -0.246261 13.7617 1.22936 12.0873 3.99311C10.9811 5.8203 10.983 8.03936 12.0723 10.1562C11.4523 10.8944 10.9991 11.7579 10.7439 12.6875L9.21859 11.1566C9.95171 9.62561 9.92359 8.02999 9.12484 6.70436C7.88734 4.66155 5.03078 3.56655 1.48421 3.77468C1.30073 3.78539 1.12757 3.86311 0.997607 3.99307C0.867644 4.12303 0.789928 4.29619 0.779212 4.47968C0.57015 8.02624 1.66609 10.8828 3.7089 12.1203C4.38302 12.5322 5.15767 12.7502 5.94765 12.7503C6.71443 12.7409 7.46928 12.5592 8.1564 12.2187L10.5002 14.5625V17.2503C10.5002 17.4492 10.5792 17.64 10.7198 17.7806C10.8605 17.9213 11.0512 18.0003 11.2502 18.0003C11.4491 18.0003 11.6398 17.9213 11.7805 17.7806C11.9211 17.64 12.0002 17.4492 12.0002 17.2503V14.4856C11.9968 13.2925 12.4028 12.1343 13.1505 11.2044C14.1151 11.7085 15.1849 11.9783 16.2733 11.9919C17.3255 11.9953 18.3582 11.7078 19.2573 11.1612C22.0211 9.48874 23.5005 5.59249 23.2155 0.739989ZM4.48234 10.8378C3.04421 9.96686 2.23046 7.9053 2.25015 5.2503C4.90515 5.2278 6.96671 6.04436 7.83765 7.48249C8.29234 8.23249 8.3664 9.10718 8.06827 10.0081L5.77984 7.71968C5.63804 7.58496 5.44923 7.51097 5.25366 7.51347C5.05809 7.51598 4.87123 7.59478 4.73293 7.73308C4.59463 7.87138 4.51582 8.05824 4.51332 8.25381C4.51082 8.44938 4.58481 8.63819 4.71953 8.77999L7.00796 11.0684C6.10703 11.3666 5.23328 11.2925 4.48234 10.8378ZM18.4802 9.87968C17.2239 10.64 15.7473 10.6981 14.2473 10.0672L19.2808 5.0328C19.4155 4.89101 19.4895 4.70219 19.487 4.50662C19.4845 4.31105 19.4057 4.12419 19.2674 3.98589C19.1291 3.84759 18.9422 3.76879 18.7466 3.76628C18.5511 3.76378 18.3623 3.83777 18.2205 3.97249L13.1861 9.0003C12.5523 7.5003 12.6095 6.0228 13.3736 4.76749C14.6805 2.61124 17.7798 1.40936 21.7483 1.50218C21.8383 5.46968 20.6383 8.5728 18.4802 9.87968Z",
        fill: "#4D4D4D",
        viewBox: "0 -4 24 24",
        routerActive: [
            "/top",
            "/top",
            "/top",
        ],
        regexRouterActive: [
            /\/create-lesson\/success\?lesson_id=\d+/,
            /\/teacher\/\d+\/course/,
            /\/teacher\/record/,
        ],
    },
    {
        id: 2,
        route: "top",
        label: "リクエスト",
        path: "M21.0004 4.5V19.5C21.0004 19.8978 20.8424 20.2794 20.5611 20.5607C20.2798 20.842 19.8982 21 19.5004 21H12.7504C12.5515 21 12.3607 20.921 12.2201 20.7803C12.0794 20.6397 12.0004 20.4489 12.0004 20.25C12.0004 20.0511 12.0794 19.8603 12.2201 19.7197C12.3607 19.579 12.5515 19.5 12.7504 19.5H19.5004V4.5H4.50042V13.5C4.50042 13.6989 4.4214 13.8897 4.28075 14.0303C4.14009 14.171 3.94933 14.25 3.75042 14.25C3.5515 14.25 3.36074 14.171 3.22009 14.0303C3.07943 13.8897 3.00042 13.6989 3.00042 13.5V4.5C3.00042 4.10218 3.15845 3.72064 3.43976 3.43934C3.72106 3.15804 4.10259 3 4.50042 3H19.5004C19.8982 3 20.2798 3.15804 20.5611 3.43934C20.8424 3.72064 21.0004 4.10218 21.0004 4.5ZM11.781 14.4694C11.7114 14.3996 11.6287 14.3443 11.5376 14.3066C11.4466 14.2688 11.349 14.2494 11.2504 14.2494C11.1519 14.2494 11.0543 14.2688 10.9632 14.3066C10.8722 14.3443 10.7894 14.3996 10.7198 14.4694L6.00042 19.1897L4.28104 17.4694C4.21136 17.3997 4.12863 17.3444 4.03759 17.3067C3.94654 17.269 3.84896 17.2496 3.75042 17.2496C3.65187 17.2496 3.55429 17.269 3.46324 17.3067C3.3722 17.3444 3.28947 17.3997 3.21979 17.4694C3.15011 17.5391 3.09483 17.6218 3.05712 17.7128C3.01941 17.8039 3 17.9015 3 18C3 18.0985 3.01941 18.1961 3.05712 18.2872C3.09483 18.3782 3.15011 18.4609 3.21979 18.5306L5.46979 20.7806C5.53945 20.8504 5.62216 20.9057 5.71321 20.9434C5.80426 20.9812 5.90186 21.0006 6.00042 21.0006C6.09898 21.0006 6.19657 20.9812 6.28762 20.9434C6.37867 20.9057 6.46139 20.8504 6.53104 20.7806L11.781 15.5306C11.8508 15.461 11.9061 15.3783 11.9438 15.2872C11.9816 15.1962 12.001 15.0986 12.001 15C12.001 14.9014 11.9816 14.8038 11.9438 14.7128C11.9061 14.6217 11.8508 14.539 11.781 14.4694Z",
        fill: "#4D4D4D",
        viewBox: "0 0 24 24",
        routerActive: ["/top"],
        regexRouterActive: [],
    },
    {
        id: 3,
        route: "top",
        label: "レビュー管理",
        path: "M20.25 4.5H3.75003C3.3522 4.5 2.97067 4.65804 2.68937 4.93934C2.40806 5.22064 2.25003 5.60218 2.25003 6V21C2.24833 21.2859 2.32916 21.5662 2.48281 21.8074C2.63646 22.0485 2.85641 22.2401 3.11628 22.3594C3.31486 22.4516 3.53109 22.4996 3.75003 22.5C4.10215 22.4992 4.4426 22.3736 4.71096 22.1456C4.71544 22.1427 4.71953 22.1392 4.72315 22.1353L7.7344 19.5H20.25C20.6479 19.5 21.0294 19.342 21.3107 19.0607C21.592 18.7794 21.75 18.3978 21.75 18V6C21.75 5.60218 21.592 5.22064 21.3107 4.93934C21.0294 4.65804 20.6479 4.5 20.25 4.5ZM20.25 18H7.7344C7.38117 17.9998 7.03922 18.1243 6.76878 18.3516L6.75753 18.3619L3.75003 21V6H20.25V18ZM10.875 12C10.875 11.7775 10.941 11.56 11.0646 11.375C11.1882 11.19 11.3639 11.0458 11.5695 10.9606C11.7751 10.8755 12.0013 10.8532 12.2195 10.8966C12.4377 10.94 12.6382 11.0472 12.7955 11.2045C12.9529 11.3618 13.06 11.5623 13.1034 11.7805C13.1468 11.9988 13.1245 12.225 13.0394 12.4305C12.9542 12.6361 12.81 12.8118 12.625 12.9354C12.44 13.059 12.2225 13.125 12 13.125C11.7017 13.125 11.4155 13.0065 11.2045 12.7955C10.9936 12.5845 10.875 12.2984 10.875 12ZM6.75003 12C6.75003 11.7775 6.81601 11.56 6.93962 11.375C7.06324 11.19 7.23894 11.0458 7.44451 10.9606C7.65007 10.8755 7.87628 10.8532 8.0945 10.8966C8.31273 10.94 8.51319 11.0472 8.67052 11.2045C8.82786 11.3618 8.935 11.5623 8.97841 11.7805C9.02182 11.9988 8.99954 12.225 8.91439 12.4305C8.82924 12.6361 8.68505 12.8118 8.50004 12.9354C8.31504 13.059 8.09753 13.125 7.87503 13.125C7.57666 13.125 7.29051 13.0065 7.07953 12.7955C6.86855 12.5845 6.75003 12.2984 6.75003 12ZM15 12C15 11.7775 15.066 11.56 15.1896 11.375C15.3132 11.19 15.4889 11.0458 15.6945 10.9606C15.9001 10.8755 16.1263 10.8532 16.3445 10.8966C16.5627 10.94 16.7632 11.0472 16.9205 11.2045C17.0779 11.3618 17.185 11.5623 17.2284 11.7805C17.2718 11.9988 17.2495 12.225 17.1644 12.4305C17.0792 12.6361 16.935 12.8118 16.75 12.9354C16.565 13.059 16.3475 13.125 16.125 13.125C15.8267 13.125 15.5405 13.0065 15.3295 12.7955C15.1186 12.5845 15 12.2984 15 12Z",
        fill: "#4D4D4D",
        viewBox: "0 0 24 24",
        routerActive: ["/top"],
        regexRouterActive: [/\/teacher\/review\/\d+/],
    },
    {
        id: 4,
        route: "top",
        label: "売上管理",
        path: "M21.75 19.5C21.75 19.6989 21.671 19.8897 21.5303 20.0303C21.3897 20.171 21.1989 20.25 21 20.25H3C2.80109 20.25 2.61032 20.171 2.46967 20.0303C2.32902 19.8897 2.25 19.6989 2.25 19.5V4.5C2.25 4.30109 2.32902 4.11032 2.46967 3.96967C2.61032 3.82902 2.80109 3.75 3 3.75C3.19891 3.75 3.38968 3.82902 3.53033 3.96967C3.67098 4.11032 3.75 4.30109 3.75 4.5V13.3472L8.50594 9.1875C8.63536 9.07421 8.79978 9.00885 8.97165 9.00236C9.14353 8.99587 9.31241 9.04866 9.45 9.15188L14.9634 13.2872L20.5059 8.4375C20.5786 8.36556 20.6652 8.30925 20.7605 8.27201C20.8557 8.23478 20.9575 8.21741 21.0597 8.22097C21.1619 8.22454 21.2623 8.24896 21.3547 8.29275C21.4471 8.33653 21.5296 8.39875 21.5971 8.47558C21.6645 8.5524 21.7156 8.64222 21.7471 8.7395C21.7786 8.83678 21.7899 8.93948 21.7802 9.04128C21.7706 9.14307 21.7402 9.24182 21.691 9.33146C21.6418 9.42109 21.5748 9.49972 21.4941 9.5625L15.4941 14.8125C15.3646 14.9258 15.2002 14.9912 15.0283 14.9976C14.8565 15.0041 14.6876 14.9513 14.55 14.8481L9.03656 10.7147L3.75 15.3403V18.75H21C21.1989 18.75 21.3897 18.829 21.5303 18.9697C21.671 19.1103 21.75 19.3011 21.75 19.5Z",
        fill: "#4D4D4D",
        viewBox: "0 0 24 24",
        routerActive: ["top"],
        regexRouterActive: [],
    },
];

watch(
    () => window.location.pathname,
    (newPath) => {
        if (
            ![
                "/top",
                "/top",
                "/top",
                "/top",
                "/top",
            ].includes(newPath)
        ) {
            selectedMenuItem.value = null;
        } else if (newPath === "/top") {
            selectedMenuItem.value = 0;
        }
    },
    { immediate: true }
);

const isRouteActive = (routeNames) => {
    return routeNames?.some(
        (routeName) => window.location.pathname === routeName
    );
};

const isRouteDetailActive = (routeNamesRegex) => {
    return routeNamesRegex?.some((routeNameRegex) =>
        routeNameRegex?.test(window.location.pathname)
    );
};
</script>

<template>
    <div class="side-menu">
        <div class="d-flex side-menu-content">
            <Link
                v-for="menuItem in menuItems"
                :key="menuItem.id"
                :class="[
                    'd-flex',
                    'align-items-center',
                    'justify-content-between',
                    'side-menu-content-item',
                    {
                        isCurrentTab:
                            isRouteActive(menuItem.routerActive) ||
                            isRouteDetailActive(menuItem.regexRouterActive),
                    },
                ]"
                :href="route(menuItem.route)"
                @click="selectMenuItem(menuItem.id)"
            >
                <div
                    class="d-flex align-items-center side-menu-content-item-left"
                >
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" :viewBox="menuItem.viewBox" fill="none">
                        <path :d="menuItem.path" :fill="menuItem.fill" />
                    </svg>
                    <div>{{ menuItem.label }}</div>
                </div>
                <img
                    src="/img/icon/MultiLanguage/caret-right-multilang.svg"
                    alt=""
                />
            </Link>
            <div class="side-menu-line"></div>
            <div
                class="d-flex align-items-center justify-content-between side-menu-content-item"
            >
                <div
                    class="d-flex align-items-center side-menu-content-item-left"
                >
                    <svg
                        xmlns="http://www.w3.org/2000/svg"
                        width="20"
                        height="20"
                        viewBox="0 0 20 20"
                        fill="none"
                    >
                        <path
                            d="M10.9375 14.0625C10.9375 14.2479 10.8825 14.4292 10.7795 14.5833C10.6765 14.7375 10.5301 14.8577 10.3588 14.9286C10.1875 14.9996 9.99896 15.0182 9.81711 14.982C9.63525 14.9458 9.4682 14.8565 9.33709 14.7254C9.20598 14.5943 9.11669 14.4273 9.08052 14.2454C9.04434 14.0635 9.06291 13.875 9.13387 13.7037C9.20482 13.5324 9.32499 13.386 9.47916 13.283C9.63333 13.18 9.81458 13.125 10 13.125C10.2486 13.125 10.4871 13.2238 10.6629 13.3996C10.8387 13.5754 10.9375 13.8139 10.9375 14.0625ZM10 5.625C8.27657 5.625 6.875 6.88672 6.875 8.4375V8.75C6.875 8.91576 6.94085 9.07473 7.05806 9.19194C7.17527 9.30915 7.33424 9.375 7.5 9.375C7.66576 9.375 7.82474 9.30915 7.94195 9.19194C8.05916 9.07473 8.125 8.91576 8.125 8.75V8.4375C8.125 7.57812 8.96641 6.875 10 6.875C11.0336 6.875 11.875 7.57812 11.875 8.4375C11.875 9.29688 11.0336 10 10 10C9.83424 10 9.67527 10.0658 9.55806 10.1831C9.44085 10.3003 9.375 10.4592 9.375 10.625V11.25C9.375 11.4158 9.44085 11.5747 9.55806 11.6919C9.67527 11.8092 9.83424 11.875 10 11.875C10.1658 11.875 10.3247 11.8092 10.4419 11.6919C10.5592 11.5747 10.625 11.4158 10.625 11.25V11.1938C12.05 10.932 13.125 9.79531 13.125 8.4375C13.125 6.88672 11.7234 5.625 10 5.625ZM18.125 10C18.125 11.607 17.6485 13.1779 16.7557 14.514C15.8629 15.8502 14.594 16.8916 13.1093 17.5065C11.6247 18.1215 9.99099 18.2824 8.4149 17.9689C6.8388 17.6554 5.39106 16.8815 4.25476 15.7452C3.11846 14.6089 2.34463 13.1612 2.03112 11.5851C1.71762 10.009 1.87852 8.37535 2.49348 6.8907C3.10844 5.40605 4.14985 4.1371 5.486 3.24431C6.82214 2.35152 8.39303 1.875 10 1.875C12.1542 1.87727 14.2195 2.73403 15.7427 4.25727C17.266 5.78051 18.1227 7.84581 18.125 10ZM16.875 10C16.875 8.64025 16.4718 7.31104 15.7164 6.18045C14.9609 5.04987 13.8872 4.16868 12.631 3.64833C11.3747 3.12798 9.99238 2.99183 8.65876 3.2571C7.32514 3.52237 6.10013 4.17716 5.13864 5.13864C4.17716 6.10013 3.52238 7.32513 3.2571 8.65875C2.99183 9.99237 3.12798 11.3747 3.64833 12.6309C4.16868 13.8872 5.04987 14.9609 6.18046 15.7164C7.31105 16.4718 8.64026 16.875 10 16.875C11.8227 16.8729 13.5702 16.1479 14.8591 14.8591C16.1479 13.5702 16.8729 11.8227 16.875 10Z"
                            fill="#1B1B1B"
                        />
                    </svg>
                    <div>よくある質問</div>
                </div>
                <img
                    src="/img/icon/MultiLanguage/caret-right-multilang.svg"
                    alt=""
                />
            </div>
            <div
                class="d-flex align-items-center justify-content-between side-menu-content-item"
            >
                <div
                    class="d-flex align-items-center side-menu-content-item-left"
                >
                    <svg
                        xmlns="http://www.w3.org/2000/svg"
                        width="20"
                        height="20"
                        viewBox="0 0 20 20"
                        fill="none"
                    >
                        <path
                            d="M15.7727 4.27031C15.025 3.51514 14.1357 2.91486 13.1558 2.50383C12.1758 2.09281 11.1244 1.87912 10.0617 1.875H10C7.84512 1.875 5.77849 2.73102 4.25476 4.25476C2.73102 5.77849 1.875 7.84512 1.875 10V14.375C1.875 14.8723 2.07254 15.3492 2.42417 15.7008C2.77581 16.0525 3.25272 16.25 3.75 16.25H5C5.49728 16.25 5.97419 16.0525 6.32583 15.7008C6.67746 15.3492 6.875 14.8723 6.875 14.375V11.25C6.875 10.7527 6.67746 10.2758 6.32583 9.92417C5.97419 9.57254 5.49728 9.375 5 9.375H3.15313C3.27366 8.07182 3.76315 6.83 4.56424 5.79508C5.36532 4.76016 6.44481 3.97502 7.67617 3.53169C8.90753 3.08836 10.2398 3.0052 11.5167 3.29196C12.7936 3.57872 13.9624 4.22352 14.8859 5.15078C16.0148 6.28539 16.7091 7.78052 16.8477 9.375H15C14.5027 9.375 14.0258 9.57254 13.6742 9.92417C13.3225 10.2758 13.125 10.7527 13.125 11.25V14.375C13.125 14.8723 13.3225 15.3492 13.6742 15.7008C14.0258 16.0525 14.5027 16.25 15 16.25H16.875C16.875 16.7473 16.6775 17.2242 16.3258 17.5758C15.9742 17.9275 15.4973 18.125 15 18.125H10.625C10.4592 18.125 10.3003 18.1908 10.1831 18.3081C10.0658 18.4253 10 18.5842 10 18.75C10 18.9158 10.0658 19.0747 10.1831 19.1919C10.3003 19.3092 10.4592 19.375 10.625 19.375H15C15.8288 19.375 16.6237 19.0458 17.2097 18.4597C17.7958 17.8737 18.125 17.0788 18.125 16.25V10C18.1291 8.93717 17.9234 7.88398 17.5197 6.90077C17.1161 5.91757 16.5224 5.02368 15.7727 4.27031ZM5 10.625C5.16576 10.625 5.32473 10.6908 5.44194 10.8081C5.55915 10.9253 5.625 11.0842 5.625 11.25V14.375C5.625 14.5408 5.55915 14.6997 5.44194 14.8169C5.32473 14.9342 5.16576 15 5 15H3.75C3.58424 15 3.42527 14.9342 3.30806 14.8169C3.19085 14.6997 3.125 14.5408 3.125 14.375V10.625H5ZM15 15C14.8342 15 14.6753 14.9342 14.5581 14.8169C14.4408 14.6997 14.375 14.5408 14.375 14.375V11.25C14.375 11.0842 14.4408 10.9253 14.5581 10.8081C14.6753 10.6908 14.8342 10.625 15 10.625H16.875V15H15Z"
                            fill="#1B1B1B"
                        />
                    </svg>
                    <div>お問い合わせ</div>
                </div>
                <img
                    src="/img/icon/MultiLanguage/caret-right-multilang.svg"
                    alt=""
                />
            </div>
            <div class="side-menu-line"></div>
            <div
                class="side-menu-hint d-flex flex-column align-items-center justify-content-center mt-4 mb-4"
            >
                <div>運営会社</div>
                <div>利用規約</div>
                <div>プライバシーポリシー</div>
                <div>特定商取引法に基づく表記</div>
            </div>
            <div
                class="mt-8 side-menu-hint d-flex flex-column align-items-center justify-content-center"
            >
                © 2023 Rental House,Inc. All rights reserved
            </div>
        </div>
    </div>
</template>
<style scoped lang="scss">
@import './dashboardsidemenu';
</style>
